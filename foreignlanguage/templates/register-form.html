{% extends 'layout/base.html'%}

{% block title %} Đăng ký khóa học {% endblock %}

{% block content %}
<h1 class="text-center text-danger fw-bold">ĐĂNG KÝ KHÓA HỌC </h1>

<div class="bg-light min-vh-100 py-5">
    <div class="container">
            <div class="row">
                <div class="col-lg-7">
                    <div class="d-flex align-items-center mb-4">
                        <h2 class="fw-bold mb-0">Thông tin đăng ký</h2>
                    </div>
                    <div class="card shadow-sm border-0 mb-4">
                        <div class="card-header bg-white py-3">
                            <h5 class="mb-0 fw-bold text-primary"><i class="fas fa-user-circle me-2"></i>Thông tin học
                                viên
                            </h5>
                        </div>
                        <div class="card-body p-4">

                            <div class="mb-3">
                                <label class="form-label fw-bold small text-muted">HỌ VÀ TÊN</label>
                                <input type="text"
                                       class="form-control form-control-lg"
                                       id="name"
                                       placeholder="Nhập họ tên của bạn"
                                       required>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label class="form-label fw-bold small text-muted">EMAIL</label>
                                    <input type="email"
                                           class="form-control form-control-lg bg-light fs-6" value="{{ current_user.email }}"
                                           id="email"
                                           readonly>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label class="form-label fw-bold small text-muted">SỐ ĐIỆN THOẠI</label>
                                    <input type="text"
                                           pattern="0\d{9}"
                                           class="form-control form-control-lg bg-light fs-6"
                                           placeholder="Số điện thoại"
                                           id="phone_num"
                                           title="Số điện thoại phải có 10 chữ số và bắt đầu bằng số 0 (VD: 0912345678)" required>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="card shadow-sm border-0 mb-4">
                        <div class="card-header bg-white py-3">
                            <h5 class="mb-0 fw-bold text-primary"><i class="fas fa-credit-card me-2"></i>Thông tin khóa
                                học</h5>
                        </div>
                        <div class="d-flex gap-3 align-items-center mt-2">

                            <select id="courseSelect" class="form-select w-100" required>
                                <option selected disabled value="">-- Chọn khóa học --</option>
                                {% for c in courses %}
                                <option value="{{c.id}}">{{ c.name }}</option>
                                {% endfor %}
                            </select>

                            <select id="levelSelect" class="form-select w-100" required>
                                <option selected disabled value="">-- Chọn mục tiêu --</option>
                                {% for l in levels %}
                                <option value="{{l.id}}">{{ l.name }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="mt-3">
                            <table class="table table-hover table-bordered align-middle text-center shadow-sm d-none" id="tableClasses">
                                <thead class="table-primary">
                                <tr>
                                    <td>Chọn lớp</td>
                                    <td>Mã lớp</td>
                                    <td>Thời gian bắt đầu</td>
                                    <td>Số lượng học viên</td>
                                </tr>
                                </thead>
                                <tbody id="tableBodyClasses">

                                </tbody>
                            </table>
                        </div>

                        <div class="alert alert-info text-center m-1" id="tableInform">Không có kết quả tìm kiếm phù hợp.</div>

                    </div>

                    <div class="card shadow-sm border-0 mb-4">
                        <div class="card-header bg-white py-3">
                            <h5 class="mb-0 fw-bold text-primary"><i class="fas fa-credit-card me-2"></i>Phương thức
                                thanh toán</h5>
                        </div>
                        <div class="card-body p-0">
                            <div class="list-group list-group-flush">
                                {% for p in payment_methods %}
                                <label class="list-group-item py-3 px-4 d-flex align-items-center gap-3 cursor-pointer methods" >
                                    <input class="form-check-input flex-shrink-0" type="radio" name="payment_method"
                                           value="{{p.value}}"
                                           style="transform: scale(1.3);">
                                    <div class="flex-grow-1">
                                        <h6 class="mb-0 fw-bold methodName">{{p.name}}</h6>
                                    </div>
                                    <i class="fas fa-qrcode fs-3 text-muted"></i>
                                </label>
                                {% endfor %}

                            </div>
                        </div>
                    </div>

                    <div class="card shadow-sm border-0 mb-4">
                        <div class="card-header bg-white py-3">
                            <h6 class="mb-0 fw-bold text-primary">
                                <i class="fas fa-hand-holding-usd me-2"></i>Mức thanh toán
                            </h6>
                        </div>

                        <div class="card-body p-3 list-percent">
                            <label class="payment-option border rounded p-3 mb-3 d-flex align-items-center cursor-pointer position-relative selected-option"
                                   id="label-100">
                                <div class="form-check">
                                    <input class="form-check-input" type="radio" name="payment_percent"
                                           id="payFull" value="100" checked
                                           style="transform: scale(1.3);">
                                </div>
                                <div class="ms-3 flex-grow-1">
                                    <h6 class="fw-bold mb-0 text-dark percentName">Thanh toán toàn bộ (100%)</h6>
                                    <small class="text-success"><i class="fas fa-check-circle me-1"></i>Hoàn tất học phí
                                        ngay</small>
                                </div>
                                <i class="fas fa-award text-secondary opacity-25 fs-2"></i>
                            </label>

                            <label class="payment-option border rounded p-3 d-flex align-items-start cursor-pointer position-relative"
                                   id="label-50">
                                <div class="form-check mt-1">
                                    <input class="form-check-input" type="radio" name="payment_percent"
                                           id="payHalf" value="50"
                                           style="transform: scale(1.3);">
                                </div>
                                <div class="ms-3 flex-grow-1">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <h6 class="fw-bold mb-0 text-dark percentName">Thanh toán trước 50%</h6>
                                        <i class="fas fa-hourglass-half text-secondary opacity-25 fs-3"></i>
                                    </div>

                                    <div class="alert alert-warning border-0 bg-warning bg-opacity-10 py-1 small rounded mb-0">
                                        <i class="fas fa-clock text-warning ms-1"></i>
                                        Lưu ý: Giữ chỗ trong <strong>24h</strong>. Vui lòng hoàn tất phần còn lại sau.
                                    </div>
                                </div>
                            </label>
                        </div>
                    </div>

                    <div class="text-center mt-3">
                        <small class="text-muted"><i class="fas fa-lock me-1"></i> Thông tin của bạn sẽ được bảo mật
                            theo
                            chính sách bảo mật.</small>
                    </div>
                </div>

                <div class="col-lg-5">
                    <div class="card shadow border-0 bg-white" style="top: 20px;">
                        <div class="card-body p-4">
                            <h5 class="fw-bold mb-4">Hóa đơn của bạn</h5>

                            <div class="d-flex gap-3 mb-4">
                                <img src="https://res.cloudinary.com/desvczltb/image/upload/v1763545951/writting.avif"
                                     class="rounded"
                                     style="width: 80px; height: 80px; object-fit: cover;"
                                     alt="Course Thumb">
                                <div>
                                    <h6 class="fw-bold mb-1"
                                        style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;" id="courseName">

                                    </h6>
                                    <span class="badge bg-info text-dark" id="levelName"></span>
                                </div>
                            </div>

                            <hr class="text-muted opacity-25">

                            <div class="d-flex justify-content-between mb-2">
                                <span class="text-muted">Mã lớp:</span>
                                <span class="fw-bold" id="classId"></span>
                            </div>
                            <div class="d-flex justify-content-between mb-2">
                                <span class="text-muted">Thời gian dự kiến bắt đầu:</span>
                                <span class="fw-bold" id="startTime"></span>
                            </div>

                            <div class="d-flex justify-content-between mb-2 bg-light p-2 rounded">
                                <span class="text-dark fw-bold small pt-1">Phương thức thanh toán:</span>
                                <span class="fw-bold text-primary" id="methodPay"></span>
                            </div>
                            <div class="d-flex justify-content-between mb-4 bg-light p-2 rounded">
                                <span class="text-dark fw-bold small pt-1">Mức thanh toán:</span>
                                <span class="fw-bold text-primary" id="percentPay"></span>
                            </div>

                            <hr>

                            <div class="d-flex justify-content-between align-items-center mb-3">
                                <span class="fw-bold fs-5">Cần thanh toán:</span>
                                <span class="fw-bold fs-3 text-danger" id="totalPrice"></span>
                            </div>


                            <button type="button" class="btn btn-danger w-100 py-3 fw-bold fs-5 shadow hover-scale" id="btnRegister">
                                XÁC NHẬN & THANH TOÁN
                            </button>
                        </div>
                    </div>
                </div>
            </div>
    </div>
</div>
<script src="{{ url_for('static', filename='js/register.js') }}" defer></script>
{% endblock %}